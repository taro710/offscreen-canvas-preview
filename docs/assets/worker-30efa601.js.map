{"version":3,"file":"worker-30efa601.js","sources":["../src/offscreen/worker.ts"],"sourcesContent":["// Workerでの処理に必要な外部スクリプトを読み込む\nimportScripts('https://unpkg.com/three@0.158.0/build/three.js');\n\nlet canvas: OffscreenCanvas & { style: { width: number; height: number } };\nlet sizes: { width: number; height: number };\nlet renderer: WebGLRenderer;\nconst meshList = [];\n// onmessageイベントハンドラーでメインスレッドからのメッセージを受け取る\nonmessage = (event) => {\n  // FIXME:\n  if (event.data.type !== 'update') {\n    canvas = event.data.canvas;\n    sizes = event.data.sizes;\n    canvas.style = { width: sizes.width, height: sizes.height };\n    renderer = new THREE.WebGLRenderer({ canvas });\n  }\n\n  const scene = new THREE.Scene();\n\n  const camera = new THREE.PerspectiveCamera(45, 1, 0.1, 500);\n  camera.aspect = sizes.width / sizes.height;\n  camera.updateProjectionMatrix();\n  scene.add(camera);\n\n  renderer.setSize(sizes.width, sizes.height);\n\n  renderer.shadowMap.enabled = true;\n\n  const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);\n  const directionalLight = new THREE.DirectionalLight(0xffffff, 2);\n  const directionalLight2 = new THREE.DirectionalLight(0xffffff, 2);\n  directionalLight.position.set(0, 1, 0);\n  directionalLight2.position.set(0, -1, 0);\n  scene.add(ambientLight);\n  scene.add(directionalLight);\n  scene.add(directionalLight2);\n\n  const params = event.data.params;\n\n  const Sphere = new THREE.BoxGeometry(0.08, 0.08, 0.08);\n  const meshInit = (boxCount: number) => {\n    meshList.forEach((mesh) => scene.remove(mesh));\n    meshList.length = 0;\n\n    for (let i = 0; i < boxCount; i++) {\n      const color = [0xfe4365, 0x556270, 0x3fb8af, 0xffd8d8, 0x556270][Math.floor(Math.random() * 5)];\n      const material = new THREE.MeshStandardMaterial({ color });\n      const mesh = new THREE.Mesh(Sphere, material);\n      mesh.position.set(5 * (Math.random() - 0.5), 5 * (Math.random() - 0.5), 5 * (Math.random() - 0.5));\n      mesh.rotation.set(Math.random() * Math.PI, Math.random() * Math.PI, Math.random() * Math.PI);\n      meshList.push(mesh);\n      scene.add(mesh);\n    }\n  };\n\n  meshInit(params.boxCount);\n\n  /**\n   * AnimationFrame\n   */\n  const clock = new THREE.Clock();\n  const tick = () => {\n    const elapsedTime = clock.getElapsedTime();\n\n    camera.position.x = 12 * Math.cos(elapsedTime * 0.5);\n    camera.position.z = 12 * Math.sin(elapsedTime * 0.5);\n    camera.position.y = 12 * Math.sin(elapsedTime * 0.5);\n    camera.lookAt(new THREE.Vector3(0, 0, 0));\n\n    renderer.render(scene, camera);\n    requestAnimationFrame(tick);\n  };\n\n  tick();\n};\n"],"names":["canvas","sizes","renderer","meshList","event","scene","camera","ambientLight","directionalLight","directionalLight2","params","Sphere","boxCount","mesh","i","color","material","clock","tick","elapsedTime"],"mappings":"yBACA,cAAc,gDAAgD,EAE9D,IAAIA,EACAC,EACAC,EACJ,MAAMC,EAAW,CAAA,EAEjB,UAAaC,GAAU,CAEjBA,EAAM,KAAK,OAAS,WACtBJ,EAASI,EAAM,KAAK,OACpBH,EAAQG,EAAM,KAAK,MACnBJ,EAAO,MAAQ,CAAE,MAAOC,EAAM,MAAO,OAAQA,EAAM,QACnDC,EAAW,IAAI,MAAM,cAAc,CAAE,OAAAF,CAAQ,CAAA,GAGzC,MAAAK,EAAQ,IAAI,MAAM,MAElBC,EAAS,IAAI,MAAM,kBAAkB,GAAI,EAAG,GAAK,GAAG,EACnDA,EAAA,OAASL,EAAM,MAAQA,EAAM,OACpCK,EAAO,uBAAuB,EAC9BD,EAAM,IAAIC,CAAM,EAEhBJ,EAAS,QAAQD,EAAM,MAAOA,EAAM,MAAM,EAE1CC,EAAS,UAAU,QAAU,GAE7B,MAAMK,EAAe,IAAI,MAAM,aAAa,SAAU,EAAG,EACnDC,EAAmB,IAAI,MAAM,iBAAiB,SAAU,CAAC,EACzDC,EAAoB,IAAI,MAAM,iBAAiB,SAAU,CAAC,EAChED,EAAiB,SAAS,IAAI,EAAG,EAAG,CAAC,EACrCC,EAAkB,SAAS,IAAI,EAAG,GAAI,CAAC,EACvCJ,EAAM,IAAIE,CAAY,EACtBF,EAAM,IAAIG,CAAgB,EAC1BH,EAAM,IAAII,CAAiB,EAErB,MAAAC,EAASN,EAAM,KAAK,OAEpBO,EAAS,IAAI,MAAM,YAAY,IAAM,IAAM,GAAI,GACnCC,GAAqB,CACrCT,EAAS,QAASU,GAASR,EAAM,OAAOQ,CAAI,CAAC,EAC7CV,EAAS,OAAS,EAElB,QAASW,EAAI,EAAGA,EAAIF,EAAUE,IAAK,CACjC,MAAMC,EAAQ,CAAC,SAAU,QAAU,QAAU,SAAU,OAAQ,EAAE,KAAK,MAAM,KAAK,OAAO,EAAI,CAAC,CAAC,EACxFC,EAAW,IAAI,MAAM,qBAAqB,CAAE,MAAAD,CAAO,CAAA,EACnDF,EAAO,IAAI,MAAM,KAAKF,EAAQK,CAAQ,EAC5CH,EAAK,SAAS,IAAI,GAAK,KAAK,SAAW,IAAM,GAAK,KAAK,SAAW,IAAM,GAAK,KAAK,SAAW,GAAI,EACjGA,EAAK,SAAS,IAAI,KAAK,OAAO,EAAI,KAAK,GAAI,KAAK,OAAO,EAAI,KAAK,GAAI,KAAK,SAAW,KAAK,EAAE,EAC3FV,EAAS,KAAKU,CAAI,EAClBR,EAAM,IAAIQ,CAAI,CAChB,CAAA,GAGOH,EAAO,QAAQ,EAKlB,MAAAO,EAAQ,IAAI,MAAM,MAClBC,EAAO,IAAM,CACX,MAAAC,EAAcF,EAAM,iBAE1BX,EAAO,SAAS,EAAI,GAAK,KAAK,IAAIa,EAAc,EAAG,EACnDb,EAAO,SAAS,EAAI,GAAK,KAAK,IAAIa,EAAc,EAAG,EACnDb,EAAO,SAAS,EAAI,GAAK,KAAK,IAAIa,EAAc,EAAG,EACnDb,EAAO,OAAO,IAAI,MAAM,QAAQ,EAAG,EAAG,CAAC,CAAC,EAE/BJ,EAAA,OAAOG,EAAOC,CAAM,EAC7B,sBAAsBY,CAAI,CAAA,EAGvBA,GACP"}